# --- App ---
APP_NAME=permy-serverside
APP_ENV=dev
APP_VERSION=0.1.0
COMMIT_SHA=dev

# --- Security / TTL ---
SESSION_TTL_SECONDS=2592000          # 30 days (spec_serverside_v2)
MIGRATION_CODE_TTL_SECONDS=600       # 10 minutes
MIGRATION_TICKET_TTL_SECONDS=900     # 15 minutes
MIGRATION_LOCK_TTL_SECONDS=3600      # 1 hour
IDEMPOTENCY_TTL_SECONDS=86400        # 24 hours

# --- Limits ---
GENERATE_MAX_CHARS=20000

# --- Rate limits ---
# auth: values are impl-spec (serverside spec says "未決" -> dev spec initial)
RL_AUTH_IP_LIMIT=10
RL_AUTH_IP_WINDOW_SECONDS=600
RL_AUTH_DF_LIMIT=3
RL_AUTH_DF_WINDOW_SECONDS=600

# generate: minute burst
RL_GENERATE_MINUTE_LIMIT=5
RL_GENERATE_MINUTE_WINDOW_SECONDS=60

# migration start: impl-spec initial
RL_MIG_START_USER_LIMIT=3
RL_MIG_START_USER_WINDOW_SECONDS=86400
RL_MIG_START_IP_LIMIT=10
RL_MIG_START_IP_WINDOW_SECONDS=86400

# migration complete: fixed by serverside spec v2
RL_MIG_COMPLETE_IP_LIMIT=5
RL_MIG_COMPLETE_IP_WINDOW_SECONDS=60
MIG_COMPLETE_MAX_TRIES=10

# --- Plans ---
FREE_GENERATE_DAILY_LIMIT=3
PRO_GENERATE_DAILY_LIMIT=100

# --- Storage ---
DATABASE_URL=sqlite+aiosqlite:///./permy.db
REDIS_URL=redis://localhost:6379/0

# --- Logs ---
UVICORN_ACCESS_LOG=false
# --- AI Provider ---
AI_PROVIDER=dummy          # dummy / openai
OPENAI_API_KEY=
OPENAI_MODEL=gpt-5.2
OPENAI_INSTRUCTIONS=あなたは夜職ユーザー向けのLINE返信案を作るアシスタント。必ずA/B/Cの3案を作り、過度に短文にしない。断定しない。ユーザーが最終決定する前提で提案する。NGワードやNG表現が指定されていれば絶対に含めない。

# --- Dev (no Redis) ---
REDIS_DISABLED=false

